db1:
  container_name: mongo1
  image: mongo
  net: ${NETWORK}
    
db2:
  container_name: mongo2
  image: mongo
  net: ${NETWORK}
    
db3:
  container_name: mongo3
  image: mongo
  net: ${NETWORK}
    
db4:
  container_name: mongo4
  image: mongo
  net: ${NETWORK}

node1: 
  container_name: node1
  build: .
  dockerfile: Dockerfile_main
  net: ${NETWORK}
  volumes:
    - "./:/src/"

node2:
  container_name: node2
  build: .
  dockerfile: Dockerfile_as
  net: ${NETWORK}
  volumes:
    - "./:/src/"
  volumes_from:
    - db1

node3:
  container_name: node3
  build: .
  dockerfile: Dockerfile_bs
  net: ${NETWORK}
  volumes:
    - "./:/src/"
  volumes_from:
    - db2

node4:
  container_name: node4
  build: .
  dockerfile: Dockerfile_cs
  net: ${NETWORK}
  volumes:
    - "./:/src/"
  volumes_from:
    - db3

node5:
  container_name: node5
  build: .
  dockerfile: Dockerfile_fs
  net: ${NETWORK}
  volumes:
    - "./:/src/"
  volumes_from:
    - db4
    
node6:
  container_name: node6
  build: .
  dockerfile: Dockerfile_ss
  net: ${NETWORK}
  volumes:
    - "./:/src/"
    
nginx:
  container_name: nginx
  restart: always
  build: ./nginx/
  net: ${NETWORK}
  ports:
    - "80:80"
  volumes:
    - /www/public
  volumes_from:
    - node1
    - node2
    - node3
    - node4
    - node5
    - node6
